#!/bin/bash

###################################################
# ping scan masked with current global ip 	  #
#				#
#				#
#				#
#				#
###################################################

# check for nmap
#[ $(which nmap) != '' ] && exit 1 

# current ip
IP="$( ifconfig en0 | grep 'inet' | cut -d: -f2 | awk '{print $2}' )"
# exclude last octet
MASK="$( echo $IP | cut -c1-11 )" 
OUT_FILE="/Users/daniel/Desktop/ping-scan_$(date +%d-%m-%Y).txt"

clear
echo "##### ping scan #####"
sleep 1
echo $OUT_FILE
sleep 1
echo $IP
sleep 1
echo "Range: "$MASK"0/24"
sleep 1
# check if out file exists. if not, create it
if [ ! -f $OUT_FILE ]; then
    echo "no out. creating..."
    touch $OUT_FILE
fi 
# ping scan last octet
echo "last octet ping scan..."
nmap -sP $MASK"0/24" >> $OUT_FILE
# report number of hosts and time taken
tail -1 $OUT_FILE

# now need to sort and interpret results

# exit with status of last command
exit $?